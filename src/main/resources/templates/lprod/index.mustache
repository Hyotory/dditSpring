<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/adminlte/dist/css/adminlte.min.css" />
    <!-- jQuery -->
    <script src="/adminlte/plugins/jquery/jquery.min.js"></script>
    <!-- Bootstrap 4 -->
    <script src="/adminlte/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>

    <title>Document</title>
    <script>
        $(function(){
            //비동기 상세 모달
            //동적으로 생성 된 클래스 속성의 값이 clsTd인 요소들을 클릭
            $(document).on('click', ".clsTd",function(){
                // 그것들 중에서 클릭한 바로 그 엘리먼트
                // 달러(this): <a href="#" class="clsTd" data-lpord-id="2">P102</a>
                let lprodId = $(this).data('lprodId');
                console.log("lprodId: ",lprodId);

                $.ajax({
                    url: `/api/lprod/${lprodId}`,
                    type: "GET",
                    dataType: "json",
                    success: function(result){
                        console.log("result: ",result);
                    }
                })
            })
            //비동기 목록 출력
            //아작나써유..(피)(씨다)타써
            /*
            요청URI : /api/lprods
            요청파라미터 :
            요청방식 : post
            */
            $.ajax({
                url:"/api/lprods",
                type:"post",
                dataType:"json",
                success:function(result){
                    console.log("result : ", result);

                    let str = ``;
                    $.each(result, function(idx, lprod){
                        console.log("lprod", lprod);

                        //상세보기
                        //1) 무엇을 클릭했는가?
                        //2) 그 무엇에 대한 데이터를 모달에 출력
                    str += `
                            <tr>
                                <td>${lprod.lprodId}</td>
                                <td><a href="#" class="clsTd" data-lprod-id="${lprod.lprodId}"> ${lprod.lprodGu}</a></td>
                                <td>${lprod.lprodNm}</td>
                            </tr>
                            `;
                    });
                    console.log("str: ", str);
                    $("#tbdy").html(str);
                }
            });
        });
    </script>
</head>
<body>
<!-- Main content -->
<section class="content">
    <div class="container-fluid">
        <!-- ///// body 시작 ///// -->
        <!-- msg 사용 범위 설정 시작
        rttr.addFlashAttribute("msg","삭제했습니다");
        -->
        {{#msg}}
        <div class="alert alert-primary alert-dismissible"><!-- 메시지 창 작성 -->
            {{msg}}
            <button type="button" class="btn-close" data-dismiss="alert" aria-label="Close">Close</button>
        </div>
        {{/msg}}
        <!-- msg 사용 범위 설정 끝 -->
        <table class="table">
            <thead>
                <tr>
                    <th scope="col">상품분류 아이디</th>
                    <th scope="col">상품분류 구분코드</th>
                    <th scope="col">상품분류 명</th>
                </tr>
            </thead>
            <tbody id="tbdy">
            <!--
            {{#lprodList}}
            <tr>
                <td>{{lprodId}}</td>
                <td><a href="/lprod/{{lprodId}}">{{lprodGu}}</a></td>
                <td>{{lprodNm}}</td>
            </tr>
            {{/lprodList}}
            -->
            </tbody>
        </table>
        <a href="/lprod/new" class="btn btn-primary">New Lprod</a>
        <!-- ///// body 끝 ///// -->
    </div><!-- /.container-fluid -->
</section>
<!-- /.content -->


</body>
</html>